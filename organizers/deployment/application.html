<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Deploying the Host Module" href="host.html" /><link rel="prev" title="Deployment" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Deploying the Application Module - TIRA</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=f683db87" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">TIRA</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://github.com/tira-io/tira-branding/raw/master/tira-icons/logo-tira-120x120-transparent.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../users/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users/faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Organizers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../organizing-tasks.html">Organizing Tasks</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Deployment</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Deployment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Deploying the Application Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="host.html">Deploying the Host Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend.html">Deploying the Frontend</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maintenance.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing/internals.html">Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing/guidelines.html">Code Guidelines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/frontend/index.html">Frontend Development</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Frontend Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/frontend/workflow.html">Workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/backend/index.html">Backend Development</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Backend Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/backend/workflow.html">Workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/python-client/index.html">Developing the Python Client</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Developing the Python Client</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/python-client/workflow.html">Workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/specification/index.html">Specification</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Specification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/specification/userstories.html">User Stories</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/tira-io/tira/edit/development/python-client/sphinx/organizers/deployment/application.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="deploying-the-application-module">
<h1>Deploying the Application Module<a class="headerlink" href="#deploying-the-application-module" title="Link to this heading">#</a></h1>
<section id="development-setup">
<h2>Development Setup<a class="headerlink" href="#development-setup" title="Link to this heading">#</a></h2>
<p>The following steps will setup a self-contained, local tira application and a mockup tira host. See <a class="reference internal" href="#development">Development</a> for
more detailed options.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install Python3, pip and virtualenv</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-venv<span class="w"> </span>libmysqlclient-dev
<span class="c1"># Setup the local environment</span>
make<span class="w"> </span>setup<span class="w">  </span><span class="c1"># This creates the virtual environment and prepares Django&#39;s database</span>
<span class="c1"># Setup the local environment</span>
make<span class="w"> </span>run-develop<span class="w">  </span><span class="c1"># This updates the config and runs the server within the venv.</span>
</pre></div>
</div>
</section>
<section id="docker">
<h2>Docker<a class="headerlink" href="#docker" title="Link to this heading">#</a></h2>
<p>You can run tira in a docker container for a simple deployment.</p>
<p>You need to run two docker containers for a tira-application:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">registry.webis.de/code-lib/public-images/tira-application</span></code> and</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">registry.webis.de/code-lib/public-images/tira-application-grpc</span></code>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>~$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--rm<span class="w"> </span>--name<span class="o">=</span>tira-application<span class="w"> </span><span class="se">\</span>
<span class="w">              </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span><span class="se">\</span>
<span class="w">              </span>-v<span class="o">=</span><span class="s2">&quot;&lt;/path/to/model&gt;&quot;</span>:/mnt/ceph/tira<span class="w"> </span><span class="se">\</span>
<span class="w">              </span>registry.webis.de/code-lib/public-images/tira-application:latest

~$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--rm<span class="w"> </span>--name<span class="o">=</span>tira-application-grpc<span class="w"> </span><span class="se">\</span>
<span class="w">             </span>-p<span class="w"> </span><span class="m">50052</span>:50052<span class="w"> </span><span class="se">\</span>
<span class="w">              </span>-v<span class="o">=</span><span class="s2">&quot;&lt;/path/to/model&gt;&quot;</span>:/mnt/ceph/tira<span class="w"> </span><span class="se">\</span>
<span class="w">              </span>registry.webis.de/code-lib/public-images/tira-application-grpc:latest
</pre></div>
</div>
<section id="use-tira-with-discourse-via-disraptor-optional">
<h3>Use TIRA with Discourse via Disraptor (optional)<a class="headerlink" href="#use-tira-with-discourse-via-disraptor-optional" title="Link to this heading">#</a></h3>
<p>If you set up Discourse with <a class="reference external" href="https://www.disraptor.org">Disraptor</a>, this will be useful information on how to
make TIRA work with it.</p>
<ol class="arabic">
<li><p>Since TIRA has a legacy and a Disraptor <code class="code docutils literal notranslate"><span class="pre">deployment</span></code> mode first change that to <code class="code docutils literal notranslate"><span class="pre">disraptor</span></code> in the
development config file <code class="code docutils literal notranslate"><span class="pre">application/config/tira-application-config.dev.yml</span></code>.</p></li>
<li><p>When you set up Disraptor you set a <code class="code docutils literal notranslate"><span class="pre">Disraptor</span> <span class="pre">App</span> <span class="pre">Secret</span> <span class="pre">Key</span></code> that allows Disraptor to communicate with your
web application. Since TIRA has to evaluate that this secret is correct we have to supply it to it. TIRA expects
that secret in an environment variable called <code class="code docutils literal notranslate"><span class="pre">DISRAPTOR_APP_SECRET_KEY</span></code>, so before starting your development
TIRA environment with <code class="code docutils literal notranslate"><span class="pre">make</span> <span class="pre">run-develop</span></code> or <code class="code docutils literal notranslate"><span class="pre">make</span> <span class="pre">run-git-develop</span></code> always remember to
<code class="code docutils literal notranslate"><span class="pre">export</span> <span class="pre">DISRAPTOR_APP_SECRET_KEY=&lt;your-secret-key&gt;</span></code>.</p></li>
<li><p>Lastly, of course, Disraptor has to be supplied with the routes for TIRA at <code class="code docutils literal notranslate"><span class="pre">Settings</span> <span class="pre">&gt;</span> <span class="pre">Plugins</span> <span class="pre">&gt;</span> <span class="pre">Disraptor</span></code>.
Since routes may change in the future and depending on what you want to test you maybe do no need the full set of
routes arranged it is recommended to take a look at <code class="code docutils literal notranslate"><span class="pre">application/src/tira/urls.py</span></code>.  Here is an example of
what can be used to have access to most of the <strong>current</strong> TIRA:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>From</p></th>
<th class="head"><p>To</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>/public/tira/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/public/tira/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/task/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/task/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-even"><td><p><cite>/task/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/task/*wildcard</cite></p></td>
<td><p>POST</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/api/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/api/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-even"><td><p><cite>/tira-admin</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/tira-admin</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/tira-admin/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/tira-admin/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-even"><td><p><cite>/tira-admin/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/tira-admin/*wildcard</cite></p></td>
<td><p>POST</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/static/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/static/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-even"><td><p><cite>/grpc/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/grpc/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/grpc/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/grpc/*wildcard</cite></p></td>
<td><p>POST</p></td>
</tr>
<tr class="row-even"><td><p><cite>/tasks</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/</cite></p></td>
<td><p>GET</p></td>
</tr>
<tr class="row-odd"><td><p><cite>/tira/static/*wildcard</cite></p></td>
<td><p><cite>http://127.0.0.1:8080/tira/static/*wildcard</cite></p></td>
<td><p>GET</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let’s say route A gets added here first and then route B. Rails will evaluate them from latest to earliest. So
when checking for a destination Rails will first look if route B matches before it checks route A and so on.
This can lead to states where you might see unexpected behavior if your routes (namely these with wildcards)
have interseting “To”-pools.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes Rails does not instantly take in new routes so when adding new routes you might want to restart the
Rails server.</p>
</div>
</li>
</ol>
</section>
</section>
<section id="build-and-deploy">
<h2>Build and Deploy<a class="headerlink" href="#build-and-deploy" title="Link to this heading">#</a></h2>
<section id="run-the-tests">
<h3>Run the tests<a class="headerlink" href="#run-the-tests" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># run all tests in application/src/tira/tests</span>
application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span><span class="nb">test</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>tira/tests/
<span class="c1"># run an individual test module</span>
application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span><span class="nb">test</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>tira/tests/tests.py
</pre></div>
</div>
</section>
<section id="deploy-on-kubernetes">
<h3>Deploy on Kubernetes<a class="headerlink" href="#deploy-on-kubernetes" title="Link to this heading">#</a></h3>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>This step is deprecated and the documentation must be updated</p>
</div>
<p>Add the discourse secret in the namespace via:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>???<span class="w"> </span>TODO?
</pre></div>
</div>
</section>
<section id="re-build-the-docker-images">
<h3>Re-build the docker images<a class="headerlink" href="#re-build-the-docker-images" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build the protobuf libraries from source.</span>
make<span class="w"> </span>build
<span class="c1"># This creates the virtual environment and prepares Django&#39;s database</span>
make<span class="w"> </span>setup
<span class="c1"># Build the docker image (deploy mode with nginx)</span>
make<span class="w"> </span>docker-build-tira-application
<span class="c1"># Run the docker container with the make command (deploy mode)</span>
make<span class="w"> </span>docker-run-tira-application
<span class="c1"># (optional) Publish a new version</span>
make<span class="w"> </span>docker-publish-tira-application
</pre></div>
</div>
<p>These make targets from the deployment configuration: <code class="code docutils literal notranslate"><span class="pre">tira/application/config/settings-deploy.yml</span></code>.</p>
</section>
<section id="development">
<h3>Development<a class="headerlink" href="#development" title="Link to this heading">#</a></h3>
<p>The settings used for the development setup are: <code class="code docutils literal notranslate"><span class="pre">tira/application/config/settings-dev.yml</span></code>.</p>
<p>Frequently used development commands are:</p>
<ul>
<li><p>Start the application without any grpc server</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span>runserver<span class="w"> </span><span class="m">8080</span>
</pre></div>
</div>
</li>
<li><p>Start only the application’s grpc server</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span>grpc_server
</pre></div>
</div>
</li>
<li><p>Start the application and  the application’s grpc server. This is used in make run-develop and the container</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span>run_develop
</pre></div>
</div>
</li>
<li><p>Start the application, the application’s grpc server, and a mock host grpc server that will reply to the application
with fake commands. This is the simplest way to develop the application.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>application/src~$<span class="w"> </span>python3<span class="w"> </span>manage.py<span class="w"> </span>run_mockup
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">#</a></h2>
<p>If there are problems with the precompiled protobuf parser, you can recompile them from the <code class="code docutils literal notranslate"><span class="pre">tira/protocol</span></code>
repository and copy them to <code class="code docutils literal notranslate"><span class="pre">tira/application/src/tira/proto</span></code>.</p>
<section id="setup-on-macos-monterey-m1">
<h3>Setup on MacOS (Monterey/M1)<a class="headerlink" href="#setup-on-macos-monterey-m1" title="Link to this heading">#</a></h3>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This part of the documentation is experimental and may not work for everyone.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will assume that <a class="reference external" href="https://brew.sh/">brew</a> is installed.</p>
</div>
<ol class="arabic">
<li><p>Install required software</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brew<span class="w"> </span>install<span class="w"> </span>python@3.10<span class="w"> </span>pipenv<span class="w"> </span>pyvenv<span class="w"> </span>mariadb<span class="w"> </span>uwsgi
</pre></div>
</div>
</li>
<li><p>Inside <code class="code docutils literal notranslate"><span class="pre">tira/application/config/tira-application-config.dev.yml</span></code> change <code class="code docutils literal notranslate"><span class="pre">tira_root</span></code> to the model you
want to use.</p></li>
<li><p>From within <code class="code docutils literal notranslate"><span class="pre">tira/application</span></code> execute the makefile at least once. This copies the config and runs
<code class="code docutils literal notranslate"><span class="pre">manage.py</span> <span class="pre">index_model</span></code> once.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>setup
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If above command did not work, you may try to build the venv and install the requirements manually by executing
the following commands within <code class="code docutils literal notranslate"><span class="pre">tira/application</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3.10<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>venv
<span class="nb">source</span><span class="w"> </span>venv/bin/activat
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
</li>
</ol>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="host.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Deploying the Host Module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Deployment</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Webis
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/tira-io/tira" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Deploying the Application Module</a><ul>
<li><a class="reference internal" href="#development-setup">Development Setup</a></li>
<li><a class="reference internal" href="#docker">Docker</a><ul>
<li><a class="reference internal" href="#use-tira-with-discourse-via-disraptor-optional">Use TIRA with Discourse via Disraptor (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-and-deploy">Build and Deploy</a><ul>
<li><a class="reference internal" href="#run-the-tests">Run the tests</a></li>
<li><a class="reference internal" href="#deploy-on-kubernetes">Deploy on Kubernetes</a></li>
<li><a class="reference internal" href="#re-build-the-docker-images">Re-build the docker images</a></li>
<li><a class="reference internal" href="#development">Development</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#setup-on-macos-monterey-m1">Setup on MacOS (Monterey/M1)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>